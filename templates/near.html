{% extends "layout.html" %}

{% block title %}
    Things Nearby
{% endblock %}

{% block main %}
    <script>
        $(document).ready(function(){
            document.getElementById("myForm").addEventListener("submit", function(event){
                event.preventDefault();
                if (navigator.geolocation && document.querySelector('input[name="current"]:checked')){
                    navigator.geolocation.getCurrentPosition(function(position){
                        var latitude = position.coords.latitude;
                        var longitude = position.coords.longitude;
                        document.getElementById("location").value = latitude + "," + longitude
                        $('#myForm').submit();
                    });
                }
            })
        });
    </script>
    {% if options is defined %}
        {% for option in options %}
            <h5>{{ option }}</h5>
        {% endfor %}
    {% else %}
        <form action="/near" method="post" id="myForm">
            <h2>Location!</h2>
            <div class = "form-group">
                <input class="form-check-input" name="current" value="current location" type="checkbox" id="location">
                <label class="form-check-label">Use Current Location?</label><br>
                <input autofocus class="form-control" name="start_street" placeholder="Street" type="text">
                <input class="form-control" name="start_city" placeholder="City" type="text">
                <input class="form-control" name="start_state" placeholder="State" type="text">
            </div>
            <div class = "form-group">
                <input class="form-control" name="search" placeholder="Type of Search" type="text">
                <input class="form-control" name="number" placeholder="Number of Searches" type="number">
            </div>
            <button class="btn btn-primary" type="submit">Search!</button>
        </form>
    {% endif %}
{% endblock %}