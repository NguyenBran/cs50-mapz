{% extends "layout.html" %}

{% block title %}
    Things Nearby
{% endblock %}

{% block main %}
    <script>
    $(document).ready(function(){
        document.querySelector("input[name='current']").addEventListener("submit", function(){
            if (navigator.geolocation && document.querySelector('input[name="current"]:checked')){
                navigator.geolocation.getCurrentPosition(function(position){
                    var latitude = position.coords.latitude;
                    var longitude = position.coords.longitude;
                    document.querySelector("input[name='current']").value = latitude + "," + longitude
                    alert(document.querySelector("input[name='current']").value)
                });
            }
        });
    });
    </script>
    {% if options is defined %}
    <h2>{{ search }} nearby!</h2>
    <br>
        <ul>
            {% for option in options %}
                <li><strong>{{ option }}</strong></li>
            {% endfor %}
        </ul>
    {% else %}
        <form action="/near" method="post" id="myForm">
            <h2>Location!</h2>
            <div class = "form-group">
                <input class="form-check-input" name="current" type="checkbox" id="location">
                <label class="form-check-label">Use Current Location?</label><br>
                <input autofocus class="form-control" name="start_street" placeholder="Street" type="text">
                <input class="form-control" name="start_city" placeholder="City" type="text">
                <input class="form-control" name="start_state" placeholder="State" type="text">
            </div>
            <div class = "form-group">
                <input class="form-control" name="search" placeholder="Type of Search" type="text">
                <input class="form-control" name="number" placeholder="Number of Searches" type="number">
            </div>
            <button class="btn btn-primary" type="submit">Search!</button>
        </form>
    {% endif %}
{% endblock %}